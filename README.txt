Supplementary information / reproducible research files for the manuscript 
Title: "Federated mixed effects logistic regression based on one-time shared summary statistics"

Authors: Limpoco, M. A. A., Faes, C., Hens, N.
Code was written by Limpoco, M. A. A.
In case of questions or comments please contact liz.limpoco@uhasselt.be!

The code was written/evaluated in R with the following software versions:
R version 4.4.3 (2025-02-28)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.4.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Brussels
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.3.0   calculus_1.0.1    maxLik_1.5-2.1    miscTools_0.6-28 
 [5] reporter_1.4.4    common_1.1.3      matrixStats_1.5.0 stringr_1.5.1    
 [9] dplyr_1.1.4       medicaldata_0.2.0 lme4_1.1-36       Matrix_1.7-2     
[13] MASS_7.3-64       pracma_2.4.4      cowplot_1.1.3     ggplot2_3.5.1    
[17] reshape2_1.4.4   

loaded via a namespace (and not attached):
 [1] sandwich_3.1-1   generics_0.1.3   jpeg_0.1-10      stringi_1.8.4   
 [5] lattice_0.22-6   digest_0.6.37    magrittr_2.0.3   grid_4.4.3      
 [9] plyr_1.8.9       jsonlite_2.0.0   zip_2.3.2        scales_1.3.0    
[13] reformulas_0.4.0 Rdpack_2.6.2     cli_3.6.4        rlang_1.1.5     
[17] crayon_1.5.3     rbibutils_2.3    munsell_0.5.1    splines_4.4.3   
[21] withr_3.0.2      tools_4.4.3      nloptr_2.1.1     minqa_1.2.8     
[25] colorspace_2.1-1 boot_1.3-31      vctrs_0.6.5      R6_2.6.1        
[29] zoo_1.8-13       lifecycle_1.0.4  pkgconfig_2.0.3  pillar_1.10.1   
[33] gtable_0.3.6     fmtr_1.6.8       glue_1.8.0       Rcpp_1.0.14     
[37] tibble_3.2.1     tidyselect_1.2.1 farver_2.1.2     nlme_3.1-167    
[41] compiler_4.4.3        

Simulations, pseudo-data generation, and model estimations (folder "SIMULATION") were run in parallel using the Vlaams Supercomputer Centrum (VSC), a high-performance research computing environment:
R version 4.1.0 (2021-05-18)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Rocky Linux 8.9 (Green Obsidian)

Matrix products: default
BLAS/LAPACK: /vsc-hard-mounts/leuven-apps/rocky8/skylake/2021a/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib64/libflexiblas.so.3.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] pracma_2.3.3 MASS_7.3-54  dplyr_1.0.6  lme4_1.1-27  Matrix_1.3-4

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.6       magrittr_2.0.1   splines_4.1.0    tidyselect_1.1.1
 [5] lattice_0.20-44  R6_2.5.0         rlang_1.1.4      minqa_1.2.4     
 [9] fansi_0.5.0      grid_4.1.0       nlme_3.1-152     utf8_1.2.1      
[13] DBI_1.1.1        cli_3.6.3        ellipsis_0.3.2   assertthat_0.2.1
[17] tibble_3.1.2     lifecycle_1.0.4  crayon_1.4.1     purrr_0.3.4     
[21] nloptr_1.2.2.2   vctrs_0.6.5      glue_1.4.2       compiler_4.1.0  
[25] pillar_1.6.1     generics_0.1.0   boot_1.3-28      pkgconfig_2.0.3



This folder contains the following data and files that can be used to reproduce all analysis, figures, tables, and results of the manuscript.
It contains four subfolders which will be enumerated in order of implementation.

./SIMULATION/:
This folder contains: 
	par_settings.csv : contains the combination of number of clusters and cluster size covered in the simulation studies, as well as the seed for reproducibility. These seeds were generated by setting the mother seed set.seed(121314) and then the code sample(1e6, nrow(par_settings)).

	./scripts/:
		./orig_setting/
			This folder contains scripts used to:
			simdata.R : simulate a logistic mixed model with normally distributed random intercepts whose parameters are based on the real deidentified publicly available dataset from the R package 'medical data.'
			compute_summary.R : compute necessary summary information from the simulated datasets.
			pseudodata_2nd/3rd/4thmom.R : generate pseudo-data matching up to 2nd/3rd/4th moments of the simulated data.
			estimates.R and aic.R : compute point and interval estimates as well as AIC values from the simulated and pseudo-data. 
		./mis_1/
			estimates.R : This script is associated with the variable omission scenario wherein the models considered did not include a significant continuous variable, in comparison to the original settings.
		./mis_0/ : The scripts in this folder are similar to those in the ./orig_setting/ folder except that new simulated data are generated to examine the case of variable omission with a large random effect variance.
		./mis_2/ : The scripts in this folder are similar to those in the ./orig_setting/ folder except that new simulated data are generated to examine the case of misspecified random effects distribution.

	./intermediate_results/ : This folder contains subfolders corresponding to the scenarios covered in the scripts folder (orig_setting, mis_1, mis_0, mis_2). Further subfolders can be found inside:
		./simdata/ : The simulated data (empty; takes less than 3 minutes to generate)
		./mean_cov/ : The univariate summary statistics of the simulated data (empty; takes less than 15 minutes to generate)
		./var_cov_mat/ : The covariance matrix of the simulated data (empty; takes less than 15 minutes to generate)
		./mv_moment_3_4_bypair_df/ : The bivariate 3rd and 4th sample moments of the simulated data (empty; takes less than 15 minutes to generate)
		./mv_moment_3_4_by3_df/ : The trivariate 3rd and 4th sample moments of the simulated data (empty; takes less than 15 minutes to generate)
		./mv_moment_4_df/ : The quadvariate 4th sample moments of the simulated data (empty; takes less than 15 minutes to generate)
		./ps2/ : pseudodata matching up to the 2nd moments of the simulated data (empty but reproducible)
		./ps3/ : pseudodata matching up to the 3rd moments of the simulated data (empty but reproducible)
		./ps4/ : pseudodata matching up to the 4th moments of the simulated data (empty but reproducible)
		./point_estimates/ : Point estimates of the parameters of the logistic mixed model
		./interval_estimates/ : 95% confidence interval estimates of the parameters of the logistic mixed model
		./aic/ : AIC values of the models estimated
	./functions/ : contains all [helper] functions to implement the scripts in the ./SIMULATION/ folder.




./Figures/
This folder contains the scripts (./scripts_and_functions/) to generate all the figures (./outputs/) in the manuscript. Each script is numbered according to their numbering in the manuscript.




./DEMO/
This folder contains the scripts (./scripts_and_functions/) to analyse a deidentified real-world publicly available data from the R package medical data (https://htmlpreview.github.io/?https://github.com/higgi13425/medicaldata/blob/master/man/description_docs/covid_desc.html). It also includes code to generate the table found in the manuscript. The folders ./ps/ and ./intermediate_results/ contain the pre-processed data, the corresponding summary information, the generated pseudodata, and model estimation results of the scripts. This folder can save time when trying to reproduce the table.




./Appendix Figures/
Similar to the ./Figures/ folder, this folder contains the scripts and outputs that can be found in the Appendix of the manuscript.  
    
